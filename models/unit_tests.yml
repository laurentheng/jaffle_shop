unit_tests:
  - name: test_order_status_cleanup
    description: Test my case/when cleanup logic for status column
    model: stg_jaffle_shop__orders
    given:
      - input: source('jaffle_shop','orders')
        rows: 
            - {id: 1, status: returned}
            - {id: 2, status: return_pending}
            - {id: 3, status: completed}
            - {id: 4, status: pending}
            - {id: 5, status: shipped}
            - {id: 6, status: placed}
            - {id: 7, status: shipped_pending}
    expect:
      rows:
        - {order_id: 1, status: returned}
        - {order_id: 2, status: returned}
        - {order_id: 3, status: completed}
        - {order_id: 4, status: placed}
        - {order_id: 5, status: shipped}
        - {order_id: 6, status: placed}
        - {order_id: 7, status: shipped}
  - name: test_days_since_ordered
    description: Test my datediff calculation for days_since_ordered column
    model: stg_jaffle_shop__orders
    overrides:
      macros:
        dbt.current_timestamp: "TIMESTAMP('2024-01-15')"
    given:
      - input: source('jaffle_shop','orders')
        rows:
          - {order_date: 2024-01-01}
    expect:
      rows:
        - {order_date: 2024-01-01, days_since_ordered: 14}
